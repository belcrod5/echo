#!/usr/bin/env bash
# reset-permissions.sh — Reset *ALL* macOS privacy (TCC) permissions
#                        for bundle ID “com.falsehood.echo”
# 2025-06-29

set -eu

BUNDLE_ID="com.falsehood.echo"

###############################################################################
#  確認プロンプト
###############################################################################
echo
echo "=============================================================="
echo "⚠️  <$BUNDLE_ID> のプライバシー権限を *すべて* リセットします (tccutil reset All)"
echo "   次回起動時に macOS の許可ダイアログが再表示されます"
echo "=============================================================="
read -r -p "続行しますか？ [y/N]: " REPLY
case "$REPLY" in
  [yY]*) echo "▶ 実行します…" ;;
  *)     echo "キャンセルしました"; exit 0 ;;
esac
echo

###############################################################################
#  リセット実行
###############################################################################
echo "⟳  tccutil reset All $BUNDLE_ID"
tccutil reset All "$BUNDLE_ID"

echo "✅  完了しました。アプリを再起動してください。"
